<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Owl Spirit: Ascension</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #020617; font-family: 'Inter', sans-serif; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
        canvas { display: block; }
        .ui-layer { position: absolute; top: 0; left: 0; width: 100%; pointer-events: none; padding: 20px; color: white; z-index: 10; }
        .bar-bg { width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; margin-top: 4px; }
        .bar-fill { height: 100%; transition: width 0.3s ease; background: #facc15; }
        #upgrade-menu { position: absolute; inset: 0; background: rgba(2, 6, 23, 0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 30; pointer-events: auto; }
        #overlay { position: absolute; inset: 0; background: radial-gradient(circle, #1e293b 0%, #020617 100%); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 40; }
        .btn-spirit { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); padding: 16px 48px; border-radius: 99px; font-weight: 800; cursor: pointer; pointer-events: auto; box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); border: none; color: white; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="overlay">
            <h1 class="text-6xl font-black text-white mb-2">OWL SPIRIT</h1>
            <p class="text-indigo-300 mb-8 uppercase tracking-widest text-sm">Master of the Ascension</p>
            <button class="btn-spirit" onclick="initGame()">BEGIN FLIGHT</button>
        </div>
        <div class="ui-layer">
            <div class="flex justify-between items-start max-w-4xl mx-auto">
                <div class="w-48">
                    <div class="text-[10px] uppercase text-slate-400">Spirit Essence</div>
                    <div class="bar-bg"><div id="xp-bar" class="bar-fill" style="width: 0%"></div></div>
                </div>
                <div class="text-center">
                    <div id="score-val" class="text-4xl font-black">0</div>
                    <div class="text-[10px] uppercase text-slate-400">Meters</div>
                </div>
                <div class="w-48 text-right">
                    <div id="level-tag" class="text-xl font-bold text-indigo-400">LVL 1</div>
                </div>
            </div>
        </div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let gameActive = false, score = 0, level = 1, xp = 0, frames = 0;
        
        const owl = { x: 0, y: 0, radius: 18, vel: 0, grav: 0.4, jump: -7 };
        const obstacles = [];
        const particles = [];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            owl.x = canvas.width * 0.25;
            owl.y = canvas.height / 2;
        }

        function createPart(x, y) {
            for(let i=0; i<8; i++) {
                particles.push({x, y, vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10, life: 1});
            }
        }

        function spawnObs() {
            const gap = Math.max(150, 260 - (level * 8));
            const top = Math.random() * (canvas.height - gap - 200) + 100;
            obstacles.push({ x: canvas.width, top, bottom: top + gap, w: 60, passed: false });
        }

        function initGame() {
            document.getElementById('overlay').style.display = 'none';
            gameActive = true;
            loop();
        }

        function handleInput() { if(gameActive) owl.vel = owl.jump; }
        window.addEventListener('mousedown', handleInput);
        window.addEventListener('touchstart', (e) => { e.preventDefault(); handleInput(); }, {passive: false});

        function loop() {
            if(!gameActive) return;
            ctx.fillStyle = '#020617';
            ctx.fillRect(0,0,canvas.width, canvas.height);

            owl.vel += owl.grav;
            owl.y += owl.vel;

            if(frames % 80 === 0) spawnObs();

            obstacles.forEach((o, i) => {
                o.x -= (4 + (level * 0.5));
                ctx.fillStyle = '#1e293b';
                ctx.fillRect(o.x, 0, o.w, o.top);
                ctx.fillRect(o.x, o.bottom, o.w, canvas.height);

                if(!o.passed && o.x < owl.x) {
                    o.passed = true; score += 10; xp += 25;
                    if(xp >= level * 100) { xp = 0; level++; }
                }

                if(owl.x + 15 > o.x && owl.x - 15 < o.x + o.w && (owl.y - 15 < o.top || owl.y + 15 > o.bottom)) location.reload();
            });

            // Draw Spirit Owl
            ctx.shadowBlur = 20; ctx.shadowColor = '#818cf8';
            ctx.fillStyle = '#818cf8';
            ctx.beginPath(); ctx.arc(owl.x, owl.y, owl.radius, 0, Math.PI*2); ctx.fill();
            ctx.shadowBlur = 0;

            document.getElementById('score-val').innerText = score;
            document.getElementById('xp-bar').style.width = (xp / (level * 100)) * 100 + '%';
            document.getElementById('level-tag').innerText = 'LVL ' + level;

            if(owl.y > canvas.height || owl.y < 0) location.reload();
            frames++;
            requestAnimationFrame(loop);
        }

        window.addEventListener('resize', resize);
        resize();
    </script>
</body>
</html>
